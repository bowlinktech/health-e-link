
/** 01.07.2014 Grace **/
UPDATE `universaltranslator`.`lookuptables` SET `utTableName`='lu_ProcedureStatus' WHERE `id`='22';
INSERT INTO `universaltranslator`.`lookuptables` (`utTableName`, `displayText`, `urlId`) VALUES ('lu_Urgency', 'Urgency', '34567Urg45677');

UPDATE `universalTranslator`.`lookUpTables` SET `utTableName`='lu_ProcessStatus' WHERE `id`='21';

/** 01.10.2014 **/
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `description`=NULL WHERE `id`='1';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `description`=NULL WHERE `id`='2';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='SSL', `displayText`='Source Submission Loaded', `description`=NULL WHERE `id`='3';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='SBP', `displayText`='Submission Being Processed', `description`=NULL WHERE `id`='4';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='SRP', `displayText`='Submission Release Pending', `description`=NULL WHERE `id`='5';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='SR', `displayText`='Submission Released', `description`=NULL WHERE `id`='6';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='SRJ', `displayText`='Submission Rejected', `description`=NULL WHERE `id`='7';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayText`='Submission Saved', `description`=NULL WHERE `id`='8';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='L', `displayText`='Loaded' WHERE `id`='9';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='RP', `displayText`='Release Pending' WHERE `id`='10';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='I', `displayText`='Invalid' WHERE `id`='11';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='REL', `displayText`='Released' WHERE `id`='12';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='RJ', `displayText`='Rejected' WHERE `id`='13';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='E', `displayText`='Error' WHERE `id`='14';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='S', `displayText`='Saved' WHERE `id`='15';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='P', `displayText`='Passed', `description`=NULL WHERE `id`='16';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `category`='transaction', `displayCode`='PP', `displayText`='Pending Pickup', `description`=NULL WHERE `id`='18';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `displayCode`='C', `displayText`='Closed' WHERE `id`='17';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `description`=NULL WHERE `id`='19';
UPDATE `universaltranslator`.`lu_ProcessStatus` SET `category`='transaction', `displayCode`='REC', `displayText`='Received', `description`=NULL WHERE `id`='20';
INSERT INTO `universaltranslator`.`lu_ProcessStatus` (`category`, `displayCode`, `displayText`) VALUES ('batch', 'DNP', 'Do Not Process');
INSERT INTO `universaltranslator`.`lu_ProcessStatus` (`category`, `displayCode`, `displayText`) VALUES ('batch', 'SDL', 'Submission Delivery Locked');
INSERT INTO `universaltranslator`.`lu_ProcessStatus` (`category`, `displayCode`, `displayText`) VALUES ('batch', 'SDC', 'Submission Delivery Completed');
INSERT INTO `universaltranslator`.`lu_ProcessStatus` (`category`, `displayCode`, `displayText`) VALUES ('batch', 'SPC', 'Submission Processing Completed');


/** Grace 01.11.2014 **/

CREATE TABLE `transactionInErrors` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `batchUploadId` int(11) NOT NULL,
  `transactionId` int(11) NOT NULL,
  `fieldLabel` varchar(45) DEFAULT NULL,
  `errorColumn` varchar(5) DEFAULT NULL COMMENT 'F1, F2, F3, etc.',
  `errorValue` varchar(255) NOT NULL,
  `rpttField1Label` varchar(45) DEFAULT NULL,
  `rptField1Val` varchar(255) DEFAULT NULL,
  `rptField2Label` varchar(45) DEFAULT NULL,
  `rptField2Val` varchar(255) DEFAULT NULL,
  `rptField3Val` varchar(45) DEFAULT NULL,
  `rptField3Label` varchar(255) DEFAULT NULL,
  `rpttField4Label` varchar(45) DEFAULT NULL,
  `rptField4Val` varchar(255) DEFAULT NULL,
  `dateCreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `uploadType` varchar(1) DEFAULT 'u' COMMENT 'U for Upload and D for download',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `transactionOutErrors` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `BatchDownloads` int(11) NOT NULL,
  `transactionTargetId` int(11) NOT NULL,
  `fieldLabel` varchar(45) DEFAULT NULL,
  `errorColumn` varchar(5) DEFAULT NULL COMMENT 'F1, F2, F3, etc.',
  `errorValue` varchar(255) NOT NULL,
  `rpttField1Label` varchar(45) DEFAULT NULL,
  `rptField1Val` varchar(255) DEFAULT NULL,
  `rptField2Label` varchar(45) DEFAULT NULL,
  `rptField2Val` varchar(255) DEFAULT NULL,
  `rptField3Val` varchar(45) DEFAULT NULL,
  `rptField3Label` varchar(255) DEFAULT NULL,
  `rpttField4Label` varchar(45) DEFAULT NULL,
  `rptField4Val` varchar(255) DEFAULT NULL,
  `dateCreated` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `downloadType` varchar(1) DEFAULT 'u' COMMENT 'U for Upload and D for download',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

ALTER TABLE `universalTranslator`.`transactionInErrors` 
CHANGE COLUMN `transactionId` `transactionInId` INT(11) NOT NULL ,
ADD INDEX `batchUploadIdFK_idx` (`batchUploadId` ASC);
ALTER TABLE `universalTranslator`.`transactionInErrors` 
ADD CONSTRAINT `batchUploadIdFK`
  FOREIGN KEY (`batchUploadId`)
  REFERENCES `universalTranslator`.`batchUploads` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

  ALTER TABLE `universalTranslator`.`transactionOutErrors` 
CHANGE COLUMN `BatchDownloads` `BatchDownloadId` INT(11) NOT NULL ,
ADD INDEX `batchDLFK_idx` (`BatchDownloadId` ASC);
ALTER TABLE `universalTranslator`.`transactionOutErrors` 
ADD CONSTRAINT `batchDLFK`
  FOREIGN KEY (`BatchDownloadId`)
  REFERENCES `universalTranslator`.`BatchDownloads` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
 /** Grace 01.13.2014 **/
 ALTER TABLE `universalTranslator`.`transactionTranslatedIn` 
ADD COLUMN `configId` INT NOT NULL AFTER `transactionInId`;
 
ALTER TABLE `universalTranslator`.`transactionIn` 
CHANGE COLUMN `configId` `configId` INT(11) NULL ;

ALTER TABLE `universalTranslator`.`transactionIn` 
DROP FOREIGN KEY `configIdFK`;

/** READ ME

this will fail if you have data in transactionTranslatedIn as configId is now 0,
please update your configId or delete the rows first
 
**/

ALTER TABLE `universalTranslator`.`transactionTranslatedIn` 
ADD INDEX `ttiConfigId_idx` (`configId` ASC);
ALTER TABLE `universalTranslator`.`transactionTranslatedIn` 
ADD CONSTRAINT `ttiConfigId`
  FOREIGN KEY (`configId`)
  REFERENCES `universalTranslator`.`configurations` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
  
/** 01.13.2014 PM**/
ALTER TABLE `universalTranslator`.`transactionInErrors` 
DROP COLUMN `uploadType`,
DROP COLUMN `rptField4Val`,
DROP COLUMN `rpttField4Label`,
DROP COLUMN `rptField3Label`,
DROP COLUMN `rptField3Val`,
DROP COLUMN `rptField2Val`,
DROP COLUMN `rptField2Label`,
DROP COLUMN `rptField1Val`,
DROP COLUMN `rpttField1Label`,
DROP COLUMN `errorValue`,
DROP COLUMN `errorColumn`,
CHANGE COLUMN `fieldLabel` `configurationFormFieldsId` INT NOT NULL ;
  

ALTER TABLE `universalTranslator`.`transactionInErrors` 
ADD INDEX `configFFFKId_idx` (`configurationFormFieldsId` ASC);
ALTER TABLE `universalTranslator`.`transactionInErrors` 
ADD CONSTRAINT `configFFFKId`
  FOREIGN KEY (`configurationFormFieldsId`)
  REFERENCES `universalTranslator`.`configurationFormFields` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
  ALTER TABLE `universalTranslator`.`transactionOutErrors` 
DROP COLUMN `downloadType`,
DROP COLUMN `rptField4Val`,
DROP COLUMN `rpttField4Label`,
DROP COLUMN `rptField3Label`,
DROP COLUMN `rptField3Val`,
DROP COLUMN `rptField2Val`,
DROP COLUMN `rptField2Label`,
DROP COLUMN `rptField1Val`,
DROP COLUMN `rpttField1Label`,
DROP COLUMN `errorValue`,
DROP COLUMN `errorColumn`,
CHANGE COLUMN `fieldLabel` `configurationFormFieldsId` INT NULL DEFAULT NULL ;
  
  
  ALTER TABLE `universalTranslator`.`transactionOutErrors` 
ADD INDEX `configFFIdFK_idx` (`configurationFormFieldsId` ASC);
ALTER TABLE `universalTranslator`.`transactionOutErrors` 
ADD CONSTRAINT `configFFIdFK`
  FOREIGN KEY (`configurationFormFieldsId`)
  REFERENCES `universalTranslator`.`configurationFormFields` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
/** grace 01.14.14**/
drop table `universalTranslator`.`transactionErrors`;

/* Chad 01.14.2014 @ 10:25 AM */
ALTER TABLE `universalTranslator`.`configurations` 
ADD COLUMN `configName` VARCHAR(45) NOT NULL AFTER `stepsCompleted`;

/* Chad 01.15.2014 @ 11:43 AM */
ALTER TABLE `universaltranslator`.`users` 
ADD COLUMN `editAuthority` BIT(1) NOT NULL DEFAULT b'0' AFTER `deliverAuthority`;

/* Chad 01.15.14 @ 3:05 PM */
CREATE TABLE `universalTranslator`.`batchUploadSummary` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `batchId` INT NOT NULL,
  `transactionInId` INT NOT NULL,
  `sourceOrgId` INT NOT NULL,
  `targetOrgId` INT NOT NULL,
  `messageTypeId` INT NOT NULL,
  `sourceConfigId` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `sumBatchIdfk_idx` (`batchId` ASC),
  INDEX `sumTransactionIdfk_idx` (`transactionInId` ASC),
  INDEX `sumSourceOrgIdfk_idx` (`sourceOrgId` ASC),
  INDEX `sumTargetOrgIdfk_idx` (`targetOrgId` ASC),
  INDEX `sumMessageTypeIdfk_idx` (`messageTypeId` ASC),
  INDEX `sumConfigIdfk_idx` (`sourceConfigId` ASC),
  CONSTRAINT `sumBatchIdfk`
    FOREIGN KEY (`batchId`)
    REFERENCES `universalTranslator`.`batchUploads` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `sumTransactionIdfk`
    FOREIGN KEY (`transactionInId`)
    REFERENCES `universalTranslator`.`transactionIn` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `sumSourceOrgIdfk`
    FOREIGN KEY (`sourceOrgId`)
    REFERENCES `universalTranslator`.`organizations` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `sumTargetOrgIdfk`
    FOREIGN KEY (`targetOrgId`)
    REFERENCES `universalTranslator`.`organizations` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `sumMessageTypeIdfk`
    FOREIGN KEY (`messageTypeId`)
    REFERENCES `universalTranslator`.`messagetypes` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `sumConfigIdfk`
    FOREIGN KEY (`sourceConfigId`)
    REFERENCES `universalTranslator`.`configurations` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

/*Grace 01.16.14 */
 ALTER TABLE `universalTranslator`.`transactionTranslatedOut` 
ADD COLUMN `configId` INT NOT NULL AFTER `transactionTargetId`;

ALTER TABLE `universalTranslator`.`transactionTranslatedOut` 
ADD INDEX `ttoConfigFK_idx` (`configId` ASC);
ALTER TABLE `universalTranslator`.`transactionTranslatedOut` 
ADD CONSTRAINT `ttoConfigFK`
  FOREIGN KEY (`configId`)
  REFERENCES `universalTranslator`.`configurations` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;




