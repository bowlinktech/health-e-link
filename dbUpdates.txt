/** 2.4.14 Grace **/
UPDATE `universaltranslator`.`lookuptables` SET `utTableName`='lu_ProcedureStatuses' WHERE `id`='22';

/** Chad 2.5.14 @ 1:31 PM **/
ALTER TABLE `universalTranslator`.`message_FromProvider` 
CHANGE COLUMN `providerId` `providerId` VARCHAR(45) NULL DEFAULT NULL ;

/** grace 02.06.2014 **/
ALTER TABLE `universalTranslator`.`transactionTranslatedIn` 
ADD COLUMN `forCW` TEXT NULL AFTER `dateCreated`;

/** Chad 2.6.2014 @ 10:40 AM **/
/** Remove duplicates **/
DELETE FROM `universalTranslator`.`lu_ProcessStatus` WHERE `id`='26';
DELETE FROM `universalTranslator`.`lu_ProcessStatus` WHERE `id`='27';

/** grace 2.6.14 **/
ALTER TABLE `universalTranslator`.`transactionTranslatedOut` 
ADD COLUMN `forCW` TEXT NULL AFTER `dateCreated`;

/** Grace 02.06.2014 PM **/
ALTER TABLE `universalTranslator`.`transactionOutErrors` 
ADD COLUMN `cwId` INT NULL AFTER `errorId`,
ADD COLUMN `macroId` INT NULL AFTER `cwId`,
ADD COLUMN `validationTypeId` INT NULL AFTER `macroId`,
ADD INDEX `validationTypeFKOut_idx` (`validationTypeId` ASC),
ADD INDEX `cwFKOut_idx` (`cwId` ASC),
ADD INDEX `macroFKOut_idx` (`macroId` ASC);
ALTER TABLE `universalTranslator`.`transactionOutErrors` 
ADD CONSTRAINT `validationTypeFKOut`
  FOREIGN KEY (`validationTypeId`)
  REFERENCES `universalTranslator`.`ref_validationTypes` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION,
ADD CONSTRAINT `cwFKOut`
  FOREIGN KEY (`cwId`)
  REFERENCES `universalTranslator`.`crosswalks` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION,
ADD CONSTRAINT `macroFKOut`
  FOREIGN KEY (`macroId`)
  REFERENCES `universalTranslator`.`Macro_Names` (`ID`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
UPDATE `universalTranslator`.`lu_ErrorCodes` SET `displayText`='Failed Crosswalk', `description`='Failed Crosswalk' WHERE `id`='3';
INSERT INTO `universalTranslator`.`lu_ErrorCodes` (`displayText`, `description`) VALUES ('Failed Macro', 'Failed Macro');

/** Chad 2.7.2014 @ 12:59 PM **/
ALTER TABLE `universalTranslator`.`BatchDownloads` 
ADD COLUMN `mergeable` BIT(1) NULL DEFAULT b'0' AFTER `deleted`;


  

  /** grace 020714 **/
ALTER TABLE `universalTranslator`.`transactionOutErrors` 
DROP FOREIGN KEY `batchDLFK`;

/** grace 02.10.2014 **/

DELIMITER $$
CREATE Procedure `universaltranslator`.`runMacro`(in inConfigId int, in batchId int, 
in cdtId int, in fieldNo int, in foroutboundProcessing boolean, out fieldNoOut int) 
proc_main:begin
set fieldNoOut = 0; -- dummy for now
select fieldNoOut;

end proc_main$$
DELIMITER ;


drop procedure `universaltranslator`.`runMacro`;

DELIMITER $$
CREATE Procedure `universaltranslator`.`runMacro`(in inConfigId int, in batchId int, 
in cdtId int, in fieldNo int, in foroutboundProcessing boolean, out fieldNoOut int) 
proc_main:begin
 -- 1 - we look up macro info

declare localFormulaName varchar(255) default "";

select formula into localFormulaName from Macro_Names mc, configurationDataTranslations cdt where cdt.macroId = mc.id and cdt.id = cdtId;

-- we can have different types, there is always a formula

-- DO NO PASS

-- SP

-- Mapspec Links

-- HL7 Message


-- we will return the fieldNo for the target column so forCW values can be updated, return 0 for SP
set fieldNoOut = 0; -- dummy for now
select fieldNoOut;

end proc_main$$
DELIMITER ;


  
