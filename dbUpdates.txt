

/** 10192015 Chad  **/
ALTER TABLE `universaltranslator`.`configurationtransportdetails` 
ADD COLUMN `HL7PDFSampleTemplate` VARCHAR(45) NULL DEFAULT NULL AFTER `attachmentNote`;

/** 10292015 Chad  **/
INSERT INTO `universaltranslator`.`macro_names` (`Macro_Name`, `Macro_Short_Name`, `Formula`, `FieldA_Question`, `populateFieldA`) VALUES ('overwriteColumnWithRandomNumber', 'overwriteColumnWithRandomNumber', 'overwriteColumnWithRandomNumber', 'Please enter column to overwrite', 1);

USE `universaltranslator`;
DROP procedure IF EXISTS `overwriteColumnWithRandomNumber`;

DELIMITER $$
USE `universaltranslator`$$
CREATE DEFINER=`root`@`localhost` PROCEDURE `overwriteColumnWithRandomNumber`(in configId int, 
in batchId int, in srcField varchar(10),
in fieldA varchar(10), in fieldB varchar(10), in con1 varchar(255), 
in con2 varchar(255), in macroId int, in foroutboundProcessing boolean, in passClear int, in transactionId int)
proc_main:begin

declare _rc varchar(255);
begin
	set _rc = cast(FLOOR(1000000000 + (RAND() * 8999999999)) AS char);
    select _rc;
             
end; 


-- build our sql
if (transactionId = 0) then
	set @stmt = concat("update ",@translatedTable, " set ",fieldA," = '",_rc, "' where ",@transactionTable,"Id in (select id from ",@transactionTable,
				" where configId = ",configId," and ", @batchIdType," = ",batchId," and statusId not in (",@finalStatusIds ,"));");
	END if;


if (transactionId != 0) then
	set @stmt = concat("update ",@translatedTable, " set ",fieldA," = '",_rc,"' where ",
	@transactionTable,"Id = ", transactionId,";");
	END if;

PREPARE stmt from @stmt;
EXECUTE stmt;-- execute

-- we check pass /clear
if (passClear = 2) THEN
BEGIN
-- accessible
END;
END IF;

-- the only error for this is if SP bombs, no need to write in insert error logs
select '';
end proc_main$$

DELIMITER ;




