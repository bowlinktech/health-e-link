/** grace 12.11.2013**/

ALTER TABLE `universalTranslator`.`transactionInRecords` 
ADD INDEX `tirFK_idx` (`transactionInId` ASC);
ALTER TABLE `universalTranslator`.`transactionInRecords` 
ADD CONSTRAINT `tirFK`
  FOREIGN KEY (`transactionInId`)
  REFERENCES `universalTranslator`.`transactionIn` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

  ALTER TABLE `universalTranslator`.`transactionIn` 
ADD INDEX `uploadFK_idx` (`transactionUploadId` ASC);
ALTER TABLE `universalTranslator`.`transactionIn` 
ADD CONSTRAINT `uploadFK`
  FOREIGN KEY (`transactionUploadId`)
  REFERENCES `universalTranslator`.`transactionUploads` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
  ALTER TABLE `universalTranslator`.`transactionTarget` 
ADD INDEX `ttargetInFK_idx` (`transactionInId` ASC);
ALTER TABLE `universalTranslator`.`transactionTarget` 
ADD CONSTRAINT `ttargetInFK`
  FOREIGN KEY (`transactionInId`)
  REFERENCES `universalTranslator`.`transactionIn` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  ALTER TABLE `universalTranslator`.`message_MedicalConditions` 
CHANGE COLUMN `conditionType` `conditionTypeId` INT(11) NULL DEFAULT NULL COMMENT 'this will define if it is a problem in ccr - values could be diagnosis' ;
  
  ALTER TABLE `universalTranslator`.`message_MedicalConditions` 
ADD INDEX `mcTypeFK_idx` (`conditionTypeId` ASC);
ALTER TABLE `universalTranslator`.`message_MedicalConditions` 
ADD CONSTRAINT `mcTypeFK`
  FOREIGN KEY (`conditionTypeId`)
  REFERENCES `universalTranslator`.`message_MedicalConditions` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
  ALTER TABLE `universalTranslator`.`message_FamMemMedicalConditions` 
DROP FOREIGN KEY `fmmcConditionType`;
ALTER TABLE `universalTranslator`.`message_FamMemMedicalConditions` 
CHANGE COLUMN `conditionType` `conditionTypeId` INT(11) NULL DEFAULT NULL COMMENT 'Id from lu_MedicalConditonTypes' ;
ALTER TABLE `universalTranslator`.`message_FamMemMedicalConditions` 
ADD CONSTRAINT `fmmcConditionType`
  FOREIGN KEY (`conditionTypeId`)
  REFERENCES `universalTranslator`.`lu_MedicalConditionTypes` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  /**transport method missing key to rel_configurationTranslations**/
  ALTER TABLE `universalTranslator`.`rel_configurationDataTranslations` 
ADD INDEX `fkTransportMethod_idx` (`transportMethod` ASC);
ALTER TABLE `universalTranslator`.`rel_configurationDataTranslations` 
ADD CONSTRAINT `fkTransportMethod`
  FOREIGN KEY (`transportMethod`)
  REFERENCES `universalTranslator`.`ref_transportMethods` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  /**file type**/
  ALTER TABLE `universalTranslator`.`configurationTransportDetails` 
ADD CONSTRAINT `fkFileType`
  FOREIGN KEY (`fileType`)
  REFERENCES `universalTranslator`.`ref_fileTypes` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  /**transport method**/
  ALTER TABLE `universalTranslator`.`configurationTransportDetails` 
ADD CONSTRAINT `fkTransport`
  FOREIGN KEY (`transportMethod`)
  REFERENCES `universalTranslator`.`ref_transportMethods` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
  /**validation type **/
  ALTER TABLE `universalTranslator`.`configurationFormFields` 
ADD INDEX `fkValidationType_idx` (`validationType` ASC);
ALTER TABLE `universalTranslator`.`configurationFormFields` 
ADD CONSTRAINT `fkValidationType`
  FOREIGN KEY (`validationType`)
  REFERENCES `universalTranslator`.`ref_validationTypes` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;
  
  
  /** Grace 12.12.2013 **/
ALTER TABLE `universalTranslator`.`message_Patients` 
DROP FOREIGN KEY `phoneType2FK`,
DROP FOREIGN KEY `phoneType1FK`;

ALTER TABLE `universalTranslator`.`message_Patients` 
DROP COLUMN `phone2`,
DROP COLUMN `phoneTypeId2`,
DROP COLUMN `phone1`,
DROP COLUMN `phoneTypeId1`,
DROP INDEX `phoneType2FK_idx` ,
DROP INDEX `phoneType1FK_idx` ;
  
ALTER TABLE `universalTranslator`.`message_PatientAddresses` 
DROP FOREIGN KEY `paPhoneType1FK`,
DROP FOREIGN KEY `paPhoneType2FK`;

ALTER TABLE `universalTranslator`.`message_PatientAddresses` 
CHANGE COLUMN `phoneTypeId1` `phoneType1` VARCHAR(25) NULL DEFAULT NULL COMMENT 'id related to lu_PhoneTypes Tables' ,
CHANGE COLUMN `phoneTypeId2` `phoneType2` VARCHAR(45) NULL DEFAULT NULL COMMENT 'id related to lu_PhoneTypes Tables' ;

ALTER TABLE `universalTranslator`.`info_ProviderAddresses` DROP COLUMN `dateModified`;
ALTER TABLE `universalTranslator`.`info_providerids` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lookUpTables` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_BestTimeToCall` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_BrandNames` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Consents` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Contraceptives` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Counties` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Genders` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_GeneralHealthStatuses` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_GeneralHealths` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_HealthStatuses` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Hispanics` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Immunizations` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Languages` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Manufacturers` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_MartialStatuses` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_MedicalConditionStatuses` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_MedicalConditionTypes` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_MedicalConditions` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Medications` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_PatientStatuses` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_PayerTypes` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_PhoneTypes` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_ProcedureStatuses` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Procedures` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Races` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_TestResultsTypes` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_TestStatuses` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`lu_Tests` drop column `dateModified`;
ALTER TABLE `universalTranslator`.`message_PatientDetails` drop column `dateModified`;
  
INSERT INTO `universalTranslator`.`ref_fileTypes` (`id`, `fileType`) VALUES ('10', 'doc');
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='xml' WHERE `id`='9';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='xls' WHERE `id`='8';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='odbc' WHERE `id`='7';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='pdf' WHERE `id`='6';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='mdb' WHERE `id`='5';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='hl7' WHERE `id`='4';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='csv' WHERE `id`='3';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='txt' WHERE `id`='2';
UPDATE `universalTranslator`.`ref_fileTypes` SET `fileType`='Does not apply' WHERE `id`='1';


INSERT INTO `universalTranslator`.`ref_validationTypes` (`validationType`) VALUES ('URL');
UPDATE `universalTranslator`.`ref_validationTypes` SET `validationType`='Date' WHERE `id`='4';
UPDATE `universalTranslator`.`ref_validationTypes` SET `validationType`='Numeric' WHERE `id`='5';
UPDATE `universalTranslator`.`ref_validationTypes` SET `validationType`='Email' WHERE `id`='2';
UPDATE `universalTranslator`.`ref_validationTypes` SET `validationType`='Phone Number' WHERE `id`='3';
UPDATE `universalTranslator`.`ref_validationTypes` SET `validationType`='' WHERE `id`='1';

UPDATE `universalTranslator`.`ref_validationTypes` SET `validationType`='None' WHERE `id`='1';


ALTER TABLE `universalTranslator`.`transactionUploads` 
ADD COLUMN `transportMethodId` INT NOT NULL AFTER `batchName`;
ALTER TABLE `universalTranslator`.`transactionUploads` 
CHANGE COLUMN `transportMethodId` `transportMethodId` INT(11) NOT NULL COMMENT 'we need to know how a file was uploaded as they might change the mapping, for example, in\norg1 might have F5 as messageTypeId in FTP but F6 for messageTypeId in JSON files' ;
ALTER TABLE `universalTranslator`.`transactionUploads` 
ADD INDEX `transportMethodFK_idx` (`transportMethodId` ASC);
ALTER TABLE `universalTranslator`.`transactionUploads` 
ADD CONSTRAINT `transportMethodFK`
  FOREIGN KEY (`transportMethodId`)
  REFERENCES `universalTranslator`.`ref_transportMethods` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

/* grace 12.12.13 10:49AM */
CREATE TABLE `universalTranslator`.`ref_transactionStatus` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `status` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`));
  
  ALTER TABLE `universalTranslator`.`transactionIn` 
CHANGE COLUMN `recordStatus` `transactionStatusId` INT NOT NULL COMMENT 'Id from ref_transactionStatus\n\nCould be Rejected\nPending\nReleased\nError,\netc' ;
  
ALTER TABLE `universalTranslator`.`transactionIn` 
ADD INDEX `statusFK_idx` (`transactionStatusId` ASC);
ALTER TABLE `universalTranslator`.`transactionIn` 
ADD CONSTRAINT `statusFK`
  FOREIGN KEY (`transactionStatusId`)
  REFERENCES `universalTranslator`.`ref_transactionStatus` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

INSERT INTO `universalTranslator`.`ref_transactionStatus` (`status`) VALUES ('Error');
INSERT INTO `universalTranslator`.`ref_transactionStatus` (`status`) VALUES ('Pending Release');
INSERT INTO `universalTranslator`.`ref_transactionStatus` (`status`) VALUES ('Released');
INSERT INTO `universalTranslator`.`ref_transactionStatus` (`status`) VALUES ('Downloaded');
INSERT INTO `universalTranslator`.`ref_transactionStatus` (`status`) VALUES ('Rejected');
  
/** Grace 12.12.13 after 10:31PM **/
ALTER TABLE `universalTranslator`.`message_PatientDetails` 
RENAME TO  `universalTranslator`.`message_VisitInfo` ;

ALTER TABLE `universalTranslator`.`message_VisitInfo` 
DROP COLUMN `patientOccupation`,
DROP COLUMN `additonalContactNumber`,
DROP COLUMN `guardianName`;

ALTER TABLE `universalTranslator`.`message_Patients` 
ADD COLUMN `additonalContactNumber` VARCHAR(45) NULL AFTER `email`,
ADD COLUMN `occupation` VARCHAR(45) NULL AFTER `url`,
ADD COLUMN `guardianName` VARCHAR(45) NULL COMMENT 'name of guardian - Jane Doe, John Smith' AFTER `occupation`;

ALTER TABLE `universalTranslator`.`message_HealthcareTeams` 
ADD INDEX `providerIdFKHCT_idx` (`utProviderId` ASC);
ALTER TABLE `universalTranslator`.`message_HealthcareTeams` 
ADD CONSTRAINT `providerIdFKHCT`
  FOREIGN KEY (`utProviderId`)
  REFERENCES `universalTranslator`.`info_providers` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

CREATE TABLE `message_patientIds` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `transactionInId` int(11) NOT NULL,
  `idNum` varchar(45) NOT NULL,
  `type` varchar(45) DEFAULT NULL,
  `issuedBy` varchar(255) DEFAULT NULL,
  `dateCreated` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idTransFK_idx` (`transactionInId`),
  CONSTRAINT `idTransFK` FOREIGN KEY (`transactionInId`) REFERENCES `transactionIn` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

ALTER TABLE `universalTranslator`.`transactionTarget` 
ADD INDEX `tTargetProFK_idx` (`providerId` ASC);
ALTER TABLE `universalTranslator`.`transactionTarget` 
ADD CONSTRAINT `tTargetProFK`
  FOREIGN KEY (`providerId`)
  REFERENCES `universalTranslator`.`info_providers` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

DROP TABLE `universalTranslator`.`lu_PhoneTypes`;

/* Chad 12.13.13 @ 4:26 PM */
ALTER TABLE `universalTranslator`.`messageTypeFormFields` 
ADD COLUMN `autoPopulateTableName` VARCHAR(255) NULL DEFAULT NULL AFTER `bucketDspPos`,
ADD COLUMN `autoPopulateTableCol` VARCHAR(255) NULL DEFAULT NULL AFTER `autoPopulateTableName`;
  

ALTER TABLE `universalTranslator`.`message_ToProvider` 
CHANGE COLUMN `name` `firstname` VARCHAR(45) NULL DEFAULT NULL ,
ADD COLUMN `lastname` VARCHAR(45) NULL AFTER `firstname`;

ALTER TABLE `universalTranslator`.`configurationFormFields` 
ADD COLUMN `autoPopulateTableName` VARCHAR(255) NULL DEFAULT NULL AFTER `saveToTableCol`,
ADD COLUMN `autoPopulateTableCol` VARCHAR(255) NULL DEFAULT NULL AFTER `autoPopulateTableName`;

ALTER TABLE `universalTranslator`.`rel_configurationDataTranslations` 
DROP FOREIGN KEY `dtmacroId`;

/** 12.13.13**/
ALTER TABLE `universalTranslator`.`message_VisitInfo` 
DROP COLUMN `messageDate`,
ADD COLUMN `visitDate` DATETIME NULL AFTER `transactionInId`;

/**12.15.2013 **/
ALTER TABLE `universalTranslator`.`configurationFormFields` 
DROP FOREIGN KEY `fkValidationType`;
ALTER TABLE `universalTranslator`.`configurationFormFields` 
CHANGE COLUMN `validationType` `validationType` INT(11) NULL DEFAULT 1 ;
ALTER TABLE `universalTranslator`.`configurationFormFields` 
ADD CONSTRAINT `fkValidationType`
  FOREIGN KEY (`validationType`)
  REFERENCES `universalTranslator`.`ref_validationTypes` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;

